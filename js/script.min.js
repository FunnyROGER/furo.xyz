function extraClick(){$(".center-block .link, .menu-block li a, .works-menu li a").on("click",function(e){var t=$(this).attr("href").substring(1);extraClickHandler(e,t)}),$(window).on("hashchange",hashchange)}function hashchange(e){var t=window.location.hash.slice(1).split("/")[0],a=window.location.hash.slice(1).split("/")[1];extraClickHandler(e,t,!0,a)}function extraClickHandler(e,t,a,i){e.preventDefault?e.preventDefault():e.returnValue=!1,showExtra(t,a,i)}function changeStar(e){"me"==e&&$(".star img").attr("src","me/"+(Math.floor(14*Math.random())+1)+".jpg")}function animateH1(e,t){t&&($("#xxx").text("a"),$("#yyy").text("b"),$("#zzz").text("c")),23>e-97&&($("h1").find(".domain-top").each(function(e,t){$(t).text(String.fromCharCode($(t).text().charCodeAt(0)+1)),"h"==$(t).text()||"i"==$(t).text()?$(t).addClass("hi"):$(t).removeClass("hi")}),setTimeout(function(){animateH1($("#xxx").text().charCodeAt(0),!1)},time/10))}function birthDateToAge(e){e=new Date(e);var t=new Date,a=t.getFullYear()-e.getFullYear();return t.setFullYear(1972)<e.setFullYear(1972)?a-1:a}function aliveNumber(e,t,a){var i=1,n=$(e).attr("data-k").split("-");if("k"==n[0]&&(i=n[1]),a>t){if($(e).text((t+1).toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")),"centers"==$(e).attr("id")){var r=t%10==0&&t/10%10!=1?"центра":"центров";$("#centers-word").text(r)}$(e).hasClass("alive-number-plus")&&(a=t+2,"m"==n[0]&&(i=+(Math.random()*n[1]).toFixed(1))),$(e).hasClass("alive-number-hold")&&$.cookie($(e).attr("id"),t,{expires:7,path:"/"}),setTimeout(function(){aliveNumber($(e),t+1,a)},time/i)}}function showExtra(e,t,a){if("me"!=e&&"contacts"!=e){var i="works",n=$(".works-block");e=""==e?"works":e}else var i=e;var n=$("."+i+"-block");if(e!=window.location.hash.slice(1)||!n.hasClass("current")||t){var r,l,o=$(".extra-block > div").not(n);if($(".center-block .link, .menu-block li a, .works-menu li a").off("click"),$(window).off("hashchange",hashchange),"undefined"!=typeof hideOldExtra&&clearTimeout(hideOldExtra),"works"==i){var s=n.find(".works-menu .current"),c=n.find(".works-menu a[href *= '"+e+"']"),m=c.parent(),u=m.find("span"),f=s.find("span"),h=s.find("a"),p=$(".works-list > li"),d="works"!=e?$(".works-list > li").has("[href*= '"+e+"']"):$(".works-list > li");e!=h.attr("href").slice(1)&&(u.attr("style",""),f.attr("style",""),m[0].offsetParent&&f.animate({left:m[0].offsetLeft-s[0].offsetLeft,top:m[0].offsetTop-s[0].offsetTop,width:u.css("width")},time/3,"easeOutCirc"),setTimeout(function(){s.removeClass("current"),m.addClass("current")},time/3));var g=0,k=0;!function(){g<p.length?$(".works-block").hasClass("current")?(p.eq(g).animate({left:"100%",right:"100%"},time/12,"easeOutCirc"),g++,setTimeout(function(){g!=p.length?"":p.hide()},time/24),4>g?setTimeout(arguments.callee,time/12):setTimeout(arguments.callee,time/24)):0==g&&(p.css({left:"100%",right:"100%"}).hide(),g=p.length,setTimeout(arguments.callee,time/3)):k<d.length&&(d.eq(k).show().animate({left:"0",right:"0"},time/3,"easeOutCirc").find(".work-link").attr("href","#"+e+"/"+d.eq(k).attr("id")),k++,1!=k||a||n.animate({scrollTop:"0"},time,"easeInOutQuart"),4>k?setTimeout(arguments.callee,time/6):setTimeout(arguments.callee,time/30),k==d.length&&a&&$(".extra-block > div.current").scrollTo($("#"+a),time,{axis:"y",easing:"easeOutCirc"}))}()}var x="works"==i?p.length*(time/24)+time/12:time;if(hideOldExtra=setTimeout(function(){o.css({left:"100%",right:"-100%",display:"none"}),window.location.hash=e,setTimeout(function(){extraClick()},4)},x),$(".extra-block > div.current")[0]!=n[0]){if("me"==e&&!meNotFirst){var w,b=0;meNotFirst=!0,$("#age").text(birthDateToAge(myBirthDay)),$(".alive-number-hold").each(function(e,t){$(t).text($.cookie($(t).attr("id")))}),$(".alive-number").each(function(e,t){$(t).hasClass("alive-number-plus")?(b=+$(t).text().split(" ").join(""),w=b+2):w=+$(t).text(),aliveNumber($(t),b,w)})}changeStar(e),o.css({"z-index":"1"}),n.addClass("current").css({"z-index":"2",display:"block"}).animate({left:"0",right:"0"},time,"easeInOutQuart").find("h2").css({"margin-left":"100%"}).animate({"margin-left":"0"},1.2*time,"easeInOutQuart"),o.removeClass("current"),$(".menu-block li.current").length?("undefined"!=typeof shiftMenuMarker&&clearTimeout(shiftMenuMarker),r=$(".menu-block li a[href='#"+i+"']").parent("li").offset().top-$(".menu-block li.current").offset().top,l=$(".menu-block li a[href='#"+i+"']").parent("li").offset().left-$(".menu-block li.current").offset().left,$(".menu-block li.current").find("span").animate({"margin-top":r+"px","margin-left":l+"px"},time,"easeOutCirc"),shiftMenuMarker=setTimeout(function(){$(".menu-block li a[href='#"+i+"']").parent("li").addClass("current"),$(".menu-block li a:not([href='#"+i+"'])").parent("li").removeClass("current"),$(".menu-block li span").css({"margin-top":"0px","margin-left":"0px"})},time)):($(".menu-block li a[href='#"+i+"']").parent("li").addClass("current"),$(".menu-block li span").animate({width:"5px"},time/4))}}}var time=1e3,meNotFirst,myBirthDay="12/25/1991";$(function(){function e(){for(var e=0;e<arguments.length;e++)(new Image).src=arguments[e]}var t=window.location.hash.substring(1).split("/")[0],a=window.location.hash.substring(1).split("/")[1],i=$(".message");extraClick(),showExtra(t,!1,a),changeStar(t),e("me/1.jpg","me/2.jpg","me/3.jpg","me/4.jpg","me/5.jpg","me/6.jpg","me/7.jpg","me/8.jpg","me/9.jpg","me/10.jpg","me/11.jpg","me/12.jpg","me/13.jpg","me/14.jpg"),i.submit(function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=$(this).serialize();$.ajax({type:"POST",url:"php/send.php",data:t,success:function(){alert("Ваше сообщение отправлено!"),i.find("textarea").val("")}})}),setTimeout(function(){animateH1($("#xxx").text().charCodeAt(0),!0)},300),$(".image-popup-no-margins").magnificPopup({type:"image",closeOnContentClick:!0,closeOnBgClick:!1,closeBtnInside:!1,fixedContentPos:!0,mainClass:"mfp-no-margins mfp-with-zoom",image:{verticalFit:!0,tError:'С этой <a href="%url%">картинкой</a> что-то пошло не так:( Попробуйте <span class="link mpf-repeat" tabindex="0">еще раз</span>, а если не получится — <span class="link mpf-tell-me" d-href="#contacts" tabindex="0">сообщите</span>, пожалуйста, мне.'},zoom:{enabled:!0,duration:300},tLoading:"Еще секунду...",tClose:"Закрыть",callbacks:{open:function(){$(".mfp-full").length||(this.wrap.append('<button title="Полноразмерное изображение" type="button" class="mfp-full"><i class="fa fa-expand"></i></button>'),$(".mfp-full").on("click",function(){$(this).find("i").toggleClass("fa-expand fa-compress"),$(".mfp-wrap").toggleClass("mfp-overflow-auto")}))},updateStatus:function(e){"error"==e.status&&($(".mpf-tell-me").off("click"),$(".mfp-preloader").on("click",".mpf-tell-me",function(){$.magnificPopup.close(),window.location.hash=$(this).attr("d-href")}),$(".mfp-preloader").on("click",".mpf-repeat",function(){var e=$.magnificPopup.instance;e.updateItemHTML()}))}}}),$("html").on("wheel keydown swipeup swipedown",function(e){40==e.which?$(".extra-block > .current")[0].scrollTop+=40:38==e.which?$(".extra-block > .current")[0].scrollTop-=40:$(e.target).closest(".extra-block, .mfp-wrap").length||($(".extra-block > .current")[0].scrollTop+=e.originalEvent.deltaY)})});